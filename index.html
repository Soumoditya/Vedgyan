<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Mindmap</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: url('https://images.unsplash.com/photo-1464802686167-95917cdd6d8b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80') no-repeat center center fixed;
            background-size: cover;
            overflow: hidden;
        }
        #cy {
            width: 100vw;
            height: 100vh;
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>
    <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>
    <script src="https://unpkg.com/@bardit/cytoscape-expand-collapse@2.0.3/cytoscape-expand-collapse.js"></script>
</head>
<body>
    <div id="cy"></div>
    <script>
        // Register the extension
        cytoscape.use(cytoscapeExpandCollapse);

        // Initialize Cytoscape
        var cy = cytoscape({
            container: document.getElementById('cy'),
            style: [
                {
                    selector: 'node',
                    style: {
                        'background-color': '#666',
                        'background-image': 'data(image)',
                        'background-fit': 'cover',
                        'border-color': '#000',
                        'border-width': 3,
                        'border-opacity': 0.5,
                        'label': 'data(label)',
                        'text-valign': 'center',
                        'text-halign': 'center',
                        'color': '#fff',
                        'text-outline-color': '#000',
                        'text-outline-width': 2,
                        'width': 100,
                        'height': 100
                    }
                },
                {
                    selector: 'edge',
                    style: {
                        'width': 2,
                        'line-color': '#ccc',
                        'curve-style': 'bezier'
                    }
                },
                {
                    selector: ':parent',
                    style: {
                        'background-opacity': 0.333,
                        'background-color': '#000',
                        'shape': 'roundrectangle'
                    }
                }
            ],
            layout: {
                name: 'cose',
                idealEdgeLength: 100,
                nodeOverlap: 20,
                refresh: 20,
                fit: true,
                padding: 30,
                randomize: false,
                componentSpacing: 100,
                nodeRepulsion: 400000,
                edgeElasticity: 100,
                nestingFactor: 5,
                gravity: 80,
                numIter: 1000,
                initialTemp: 200,
                coolingFactor: 0.95,
                minTemp: 1.0
            },
            elements: [
                // Main topics
                { data: { id: 'topic1', label: 'Topic 1', image: 'https://via.placeholder.com/150?text=Topic1' } },
                { data: { id: 'topic2', label: 'Topic 2', image: 'https://via.placeholder.com/150?text=Topic2' } },
                
                // Subtopics for Topic 1 (compound nodes)
                { data: { id: 'sub1-1', label: 'Sub 1-1', parent: 'topic1', image: 'https://via.placeholder.com/150?text=Sub1-1', info: 'Information about Sub 1-1.' } },
                { data: { id: 'sub1-2', label: 'Sub 1-2', parent: 'topic1', image: 'https://via.placeholder.com/150?text=Sub1-2', info: 'Information about Sub 1-2.' } },
                
                // Subtopics for Topic 2
                { data: { id: 'sub2-1', label: 'Sub 2-1', parent: 'topic2', image: 'https://via.placeholder.com/150?text=Sub2-1', info: 'Information about Sub 2-1.' } },
                
                // Connections (strings/lines)
                { data: { id: 'e1', source: 'topic1', target: 'topic2' } }
            ]
        });

        // Initialize expand-collapse API
        var api = cy.expandCollapse({
            layoutBy: {
                name: 'cose',
                animate: true,
                randomize: false,
                fit: true,
                idealEdgeLength: 100,
                nodeOverlap: 20,
                refresh: 20,
                padding: 30,
                componentSpacing: 100,
                nodeRepulsion: 400000,
                edgeElasticity: 100,
                nestingFactor: 5,
                gravity: 80,
                numIter: 1000,
                initialTemp: 200,
                coolingFactor: 0.95,
                minTemp: 1.0
            },
            fisheye: true,
            animate: true,
            undoable: false
        });

        // Collapse all initially for a clean start
        api.collapseAll();

        // Handle tap events for expand/collapse or show info
        cy.on('tap', 'node', function(evt) {
            var node = evt.target;
            if (node.isParent() || node.children().length > 0) {
                // If it's a parent (has subtopics), toggle expand/collapse
                if (api.isExpanded(node)) {
                    api.collapseRecursively(node);
                } else {
                    api.expandRecursively(node);
                }
            } else {
                // If leaf node, show info (you can replace alert with a modal or panel)
                alert(node.data('info') + '\n\nImage: ' + node.data('image'));
            }
        });
    </script>
</body>
</html>
